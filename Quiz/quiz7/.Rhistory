x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
knots <- c(1,1.8,3:5,6.5,7,8.1,9.2,10)  # 10 => 10-4 = 6 Basis splines
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splineDesign(knots, x = x, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
bb <- splineDesign(knots, x = x, outer.ok = TRUE)
install.packages("splines")
bb <- splineDesign(knots, x = x, outer.ok = TRUE)
bb <- splines::splineDesign(knots, x = x, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
bb <- splines::splineDesign(knots, x = x, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
bb <- splines::splineDesign(knots, x = x, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
bb <- splines::splineDesign(knots, x = x, outer.ok = TRUE)
bb <- splines::splineDesign(knots, x = x, outer.ok = FALSE)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, outer.ok = TRUE)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
bb <- splines::splineDesign(knots, x = x, ord=1, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=3, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=3, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=3, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=4, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=1, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=3, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
mtext(expression(B[j](x) *"  and "* sum(B[j](x), j == 1, 6)), adj = 0)
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=3, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
# abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
# abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
# abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
abline(v = knots[c(4,length(knots)-3)], lty = 3, col = "gray10")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
# lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
View(bb)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=3, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
View(bb)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=1, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
View(bb)
x = c(73.8, 35.9, 42.3, 54.4, 74.5, 32.1)
knots = c(20, 40, 60)
x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
bb <- splines::splineDesign(knots, x = x, ord=2, outer.ok = TRUE)
plot(range(x), c(0,1), type = "n", xlab = "x", ylab = "",
main =  "B-splines - sum to 1 inside inner knots")
abline(v = knots, lty = 3, col = "light gray")
lines(x, rowSums(bb), col = "gray", lwd = 2)
matlines(x, bb, ylim = c(0,1), lty = 1)
